{"version":3,"file":"column.min.js","sources":["../src/column.js"],"sourcesContent":["import {DragDrop} from 'core/reactive';\r\nimport selectors from 'mod_kanban/selectors';\r\nimport capabilities from 'mod_kanban/capabilities';\r\nimport exporter from 'mod_kanban/exporter';\r\nimport {saveCancel} from 'core/notification';\r\nimport * as Str from 'core/str';\r\nimport {get_string as getString} from 'core/str';\r\nimport ModalForm from 'core_form/modalform';\r\nimport KanbanComponent from 'mod_kanban/kanbancomponent';\r\nimport Log from \"core/log\";\r\n\r\n/**\r\n * Component representing a column in a kanban board.\r\n */\r\nexport default class extends KanbanComponent {\r\n    /**\r\n     * Function to initialize component, called by mustache template.\r\n     * @param {*} target The id of the HTMLElement to attach to\r\n     * @returns {BaseComponent} New component attached to the HTMLElement represented by target\r\n     */\r\n    static init(target) {\r\n        let element = document.getElementById(target);\r\n        return new this({\r\n            element: element,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Called after the component was created.\r\n     */\r\n    create() {\r\n        this.id = this.element.dataset.id;\r\n    }\r\n\r\n    /**\r\n     * Watchers for this component.\r\n     * @returns {array}\r\n     */\r\n    getWatchers() {\r\n        return [\r\n            {watch: `columns[${this.id}]:updated`, handler: this._columnUpdated},\r\n            {watch: `columns[${this.id}]:deleted`, handler: this._columnDeleted},\r\n            {watch: `cards:created`, handler: this._cardCreated}\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * Called once when state is ready, attaching event listeners and initializing drag and drop.\r\n     * @param {object} state\r\n     */\r\n    stateReady(state) {\r\n        this.addEventListener(\r\n            this.getElement(selectors.DELETECOLUMN, this.id),\r\n            'click',\r\n            this._removeConfirm\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.ADDCARDFIRST),\r\n            'click',\r\n            this._addCard\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.ADDCOLUMN, this.id),\r\n            'click',\r\n            this._addColumn\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.LOCKCOLUMN, this.id),\r\n            'click',\r\n            this._lockColumn\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.UNLOCKCOLUMN, this.id),\r\n            'click',\r\n            this._unlockColumn\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.EDITDETAILS, this.id),\r\n            'click',\r\n            this._editDetails\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.SHOWHIDDEN),\r\n            'click',\r\n            this._showHidden\r\n        );\r\n        this.addEventListener(\r\n            this.getElement(selectors.HIDEHIDDEN),\r\n            'click',\r\n            this._hideHidden\r\n        );\r\n        this.draggable = false;\r\n        this.dragdrop = new DragDrop(this);\r\n        this.checkDragging(state);\r\n        this.boardid = state.board.id;\r\n        this.cmid = state.common.id;\r\n    }\r\n\r\n    /**\r\n     * Display confirmation modal for deleting a card.\r\n     * @param {*} event\r\n     */\r\n    _removeConfirm(event) {\r\n        Str.get_strings([\r\n            {key: 'deletecolumn', component: 'mod_kanban'},\r\n            {key: 'deletecolumnconfirm', component: 'mod_kanban'},\r\n            {key: 'delete', component: 'core'},\r\n        ]).then((strings) => {\r\n            return saveCancel(\r\n                strings[0],\r\n                strings[1],\r\n                strings[2],\r\n                () => {\r\n                    this._removeColumn(event);\r\n                }\r\n            );\r\n        }).catch((error) => Log.debug(error));\r\n    }\r\n\r\n    /**\r\n     * Remove all subcomponents dependencies.\r\n     */\r\n    destroy() {\r\n        if (this.dragdrop !== undefined) {\r\n            this.dragdrop.unregister();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the draggable data of this component.\r\n     *\r\n     * @returns {Object} the draggable data.\r\n     */\r\n    getDraggableData() {\r\n        return {id: this.id, type: 'column'};\r\n    }\r\n\r\n    /**\r\n     * Conditionally enable / disable dragging.\r\n     * @param {*} state\r\n     */\r\n    checkDragging(state) {\r\n        if (state === undefined) {\r\n            state = this.reactive.stateManager.state;\r\n        }\r\n\r\n        if (state.capabilities.get(capabilities.MANAGECOLUMNS).value && state.columns.get(this.id).locked == 0) {\r\n            this.dragdrop.setDraggable(true);\r\n        } else {\r\n            this.dragdrop.setDraggable(false);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Validate draggable data. This component accepts cards and columns.\r\n     * @param {object} dropdata\r\n     * @returns {boolean} if the data is valid for this drop-zone.\r\n     */\r\n    validateDropData(dropdata) {\r\n        let type = dropdata?.type;\r\n        return type == 'card' || type == 'column';\r\n    }\r\n\r\n    /**\r\n     * Executed when a valid dropdata is dropped over the drop-zone.\r\n     * @param {object} dropdata\r\n     * @param {object} event\r\n     */\r\n    drop(dropdata, event) {\r\n        if (dropdata.type == 'card') {\r\n            let cards = this.getElements(selectors.CARD);\r\n            let aftercard = 0;\r\n            for (let i = 0; i < cards.length; i++) {\r\n                if (cards[i].offsetTop + cards[i].clientHeight / 2 <= event.layerY) {\r\n                    aftercard = cards[i].dataset.id;\r\n                }\r\n            }\r\n            this.reactive.dispatch('moveCard', dropdata.id, this.id, aftercard);\r\n        }\r\n        if (dropdata.type == 'column') {\r\n            if (dropdata.id != this.id) {\r\n                this.reactive.dispatch('moveColumn', dropdata.id, this.id);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Show some visual hints to the user.\r\n     * @param {object} dropdata\r\n     * @param {object} event\r\n     */\r\n    showDropZone(dropdata, event) {\r\n        if (dropdata.type == 'card') {\r\n            let cards = this.getElements(selectors.CARD);\r\n            let aftercard = 0;\r\n            for (let i = 0; i < cards.length; i++) {\r\n                if (cards[i].offsetTop + cards[i].clientHeight / 2 <= event.layerY) {\r\n                    aftercard = cards[i].dataset.id;\r\n                }\r\n            }\r\n            if (aftercard == 0) {\r\n                this.getElement(selectors.ADDCARDCONTAINER).classList.add('mod_kanban_insert');\r\n            } else {\r\n                this.getElement(selectors.ADDCARDCONTAINER, aftercard).classList.add('mod_kanban_insert');\r\n            }\r\n        }\r\n        if (dropdata.type == 'column') {\r\n            this.getElement(selectors.ADDCOLUMNCONTAINER).classList.add('mod_kanban_insert');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Remove visual hints to the user.\r\n     */\r\n    hideDropZone() {\r\n        this.getElement(selectors.ADDCOLUMNCONTAINER).classList.remove('mod_kanban_insert');\r\n        this.getElements(selectors.ADDCARDCONTAINER).forEach((e) => {\r\n            e.classList.remove('mod_kanban_insert');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Dispatch event to add a column after this column.\r\n     * @param {*} event\r\n     */\r\n    _addColumn(event) {\r\n        document.activeElement.blur();\r\n        let target = event.target.closest(selectors.ADDCOLUMN);\r\n        let data = Object.assign({}, target.dataset);\r\n        this.reactive.dispatch('addColumn', data.id);\r\n    }\r\n\r\n    /**\r\n     * Called when a card was created in this column.\r\n     * @param {*} param0\r\n     */\r\n    async _cardCreated({element}) {\r\n        if (element.kanban_column == this.id) {\r\n            let data = JSON.parse(JSON.stringify(element));\r\n            Object.assign(data, exporter.exportCapabilities(this.reactive.state));\r\n            let placeholder = document.createElement('li');\r\n            placeholder.setAttribute('data-id', data.id);\r\n            let node = this.getElement(selectors.COLUMNINNER, this.id);\r\n            node.appendChild(placeholder);\r\n            const newcomponent = await this.renderComponent(placeholder, 'mod_kanban/card', data);\r\n            const newelement = newcomponent.getElement();\r\n            node.replaceChild(newelement, placeholder);\r\n            // Update card count after adding new card\r\n            this.getElement(selectors.CARDCOUNT).innerHTML = this.getElements(selectors.CARD).length;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Dispatch event to add a card in this column.\r\n     * @param {*} event\r\n     */\r\n    _addCard(event) {\r\n        document.activeElement.blur();\r\n        let target = event.target.closest(selectors.ADDCARD);\r\n        let data = Object.assign({}, target.dataset);\r\n        this.reactive.dispatch('addCard', data.columnid, 0);\r\n    }\r\n\r\n    /**\r\n     * Called when column is updated.\r\n     * @param {*} param0\r\n     */\r\n    _columnUpdated({element}) {\r\n        const el = this.getElement(selectors.COLUMNINNER, this.id);\r\n        if (element.sequence !== undefined) {\r\n            let sequence = element.sequence.split(',');\r\n            // Remove all cards from frontend that are no longer present in the database.\r\n            [...el.children]\r\n                .forEach((node) => {\r\n                    if (node.classList.contains('mod_kanban_card') && !sequence.includes(node.dataset.id)) {\r\n                        el.removeChild(node);\r\n                    }\r\n                });\r\n            // Reorder cards according to sequence from the database.\r\n            [...el.children]\r\n                .sort((a, b) => sequence.indexOf(a.dataset.id) > sequence.indexOf(b.dataset.id) ? 1 : -1)\r\n                .forEach(node => el.appendChild(node));\r\n        }\r\n        if (element.locked !== undefined) {\r\n            this.toggleClass(element.locked != 0, 'mod_kanban_locked_column');\r\n            // Inplace editing of the column title is disabled if the column is locked.\r\n            if (element.locked != 0) {\r\n                this.getElement(selectors.INPLACEEDITABLE).removeAttribute('data-inplaceeditable');\r\n            } else {\r\n                this.getElement(selectors.INPLACEEDITABLE).setAttribute('data-inplaceeditable', '1');\r\n            }\r\n        }\r\n        // Update data for inplace editing if title was updated (this is important if title was modified by another user).\r\n        if (element.title !== undefined) {\r\n            // For Moodle inplace editing title is once needed plain and once with html entities encoded.\r\n            // This avoids double encoding of html entities as the value of \"data-value\" is exactly what is shown\r\n            // in the input field when clicking on the inplace editable.\r\n            let doc = new DOMParser().parseFromString(element.title, 'text/html');\r\n            this.getElement(selectors.INPLACEEDITABLE).setAttribute('data-value', doc.documentElement.textContent);\r\n            this.getElement(selectors.INPLACEEDITABLE).querySelector('a').innerHTML = element.title;\r\n        }\r\n        // Only autohide option is relevant for the frontend for now. autoclose option is handled by the backend.\r\n        if (element.options !== undefined) {\r\n            let options = JSON.parse(element.options);\r\n            this.toggleClass(options.autohide, 'mod_kanban_autohide');\r\n            this.toggleClass(options.wiplimit > 0, 'mod_kanban_column_wiplimit');\r\n            this.getElement(selectors.WIPLIMIT).innerHTML = options.wiplimit;\r\n        }\r\n        this.getElement(selectors.CARDCOUNT).innerHTML = this.getElements(selectors.CARD).length;\r\n        // Enable/disable dragging (e.g. if column is locked).\r\n        this.checkDragging();\r\n    }\r\n\r\n    /**\r\n     * Called when this column is deleted.\r\n     */\r\n    _columnDeleted() {\r\n        this.destroy();\r\n    }\r\n\r\n    /**\r\n     * Dispatch event to remove this column.\r\n     * @param {*} event\r\n     */\r\n    _removeColumn(event) {\r\n        let target = event.target.closest(selectors.DELETECOLUMN);\r\n        let data = Object.assign({}, target.dataset);\r\n        this.reactive.dispatch('deleteColumn', data.id);\r\n    }\r\n\r\n    /**\r\n     * Dispatch event to lock this column.\r\n     * @param {*} event\r\n     */\r\n    _lockColumn(event) {\r\n        let target = event.target.closest(selectors.LOCKCOLUMN);\r\n        let data = Object.assign({}, target.dataset);\r\n        this.reactive.dispatch('lockColumn', data.id);\r\n    }\r\n\r\n    /**\r\n     * Dispatch event to unlock this column.\r\n     * @param {*} event\r\n     */\r\n    _unlockColumn(event) {\r\n        let target = event.target.closest(selectors.UNLOCKCOLUMN);\r\n        let data = Object.assign({}, target.dataset);\r\n        this.reactive.dispatch('unlockColumn', data.id);\r\n    }\r\n\r\n    /**\r\n     * Show modal form to edit column details.\r\n     * @param {*} event\r\n     */\r\n    _editDetails(event) {\r\n        event.preventDefault();\r\n\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_kanban\\\\form\\\\edit_column_form\",\r\n            args: {\r\n                id: this.id,\r\n                boardid: this.boardid,\r\n                cmid: this.cmid\r\n            },\r\n            modalConfig: {title: getString('editcolumn', 'mod_kanban')},\r\n            returnFocus: this.getElement(),\r\n        });\r\n        this.addEventListener(modalForm, modalForm.events.FORM_SUBMITTED, this._updateColumn);\r\n        modalForm.show();\r\n    }\r\n\r\n    /**\r\n     * Dispatch an event to update column data from the detail modal.\r\n     * @param {*} event\r\n     */\r\n    _updateColumn(event) {\r\n        this.reactive.dispatch('processUpdates', event.detail);\r\n    }\r\n\r\n    /**\r\n     * Show hidden cards.\r\n     */\r\n    _showHidden() {\r\n        this.getElement().classList.add('mod_kanban_show_hidden');\r\n    }\r\n\r\n    /**\r\n     * Hide hidden cards.\r\n     */\r\n    _hideHidden() {\r\n        this.getElement().classList.remove('mod_kanban_show_hidden');\r\n    }\r\n}\r\n"],"names":["KanbanComponent","target","this","element","document","getElementById","create","id","dataset","getWatchers","watch","handler","_columnUpdated","_columnDeleted","_cardCreated","stateReady","state","addEventListener","getElement","selectors","DELETECOLUMN","_removeConfirm","ADDCARDFIRST","_addCard","ADDCOLUMN","_addColumn","LOCKCOLUMN","_lockColumn","UNLOCKCOLUMN","_unlockColumn","EDITDETAILS","_editDetails","SHOWHIDDEN","_showHidden","HIDEHIDDEN","_hideHidden","draggable","dragdrop","DragDrop","checkDragging","boardid","board","cmid","common","event","Str","get_strings","key","component","then","strings","_removeColumn","catch","error","Log","debug","destroy","undefined","unregister","getDraggableData","type","reactive","stateManager","capabilities","get","MANAGECOLUMNS","value","columns","locked","setDraggable","validateDropData","dropdata","drop","cards","getElements","CARD","aftercard","i","length","offsetTop","clientHeight","layerY","dispatch","showDropZone","ADDCARDCONTAINER","classList","add","ADDCOLUMNCONTAINER","hideDropZone","remove","forEach","e","activeElement","blur","closest","data","Object","assign","kanban_column","JSON","parse","stringify","exporter","exportCapabilities","placeholder","createElement","setAttribute","node","COLUMNINNER","appendChild","newelement","renderComponent","replaceChild","CARDCOUNT","innerHTML","ADDCARD","columnid","el","sequence","split","children","contains","includes","removeChild","sort","a","b","indexOf","toggleClass","INPLACEEDITABLE","removeAttribute","title","doc","DOMParser","parseFromString","documentElement","textContent","querySelector","options","autohide","wiplimit","WIPLIMIT","preventDefault","modalForm","ModalForm","formClass","args","modalConfig","returnFocus","events","FORM_SUBMITTED","_updateColumn","show","detail"],"mappings":"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"}