define("mod_kanban/board",["exports","core/reactive","mod_kanban/selectors","mod_kanban/exporter"],(function(_exports,_reactive,_selectors,_exporter){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_selectors=_interopRequireDefault(_selectors),_exporter=_interopRequireDefault(_exporter);class _default extends _reactive.BaseComponent{static init(target){return new this({element:document.getElementById(target)})}create(){this.cmid=this.element.dataset.cmid,this.id=this.element.dataset.id}getWatchers(){return[{watch:"board:updated",handler:this._boardUpdated},{watch:"columns:created",handler:this._createColumn}]}async stateReady(){this.addEventListener(this.getElement(_selectors.default.ADDCOLUMNFIRST),"click",this._addColumn),this.dragdrop=new _reactive.DragDrop(this)}destroy(){void 0!==this.dragdrop&&this.dragdrop.unregister()}_boardUpdated(_ref){let{element:element}=_ref;const el=this.getElement();let sequence=element.sequence.split(",");[...el.children].sort(((a,b)=>sequence.indexOf(a.dataset.id)>sequence.indexOf(b.dataset.id)?1:-1)).forEach((node=>el.appendChild(node)))}async _createColumn(_ref2){let{element:element}=_ref2,data=Object.assign({id:element.id,title:element.title,options:element.options,sequence:element.sequence},_exporter.default.exportCapabilities(this.reactive.state)),placeholder=document.createElement("li");placeholder.setAttribute("data-id",data.id),this.getElement().appendChild(placeholder);const newelement=(await this.renderComponent(placeholder,"mod_kanban/column",data)).getElement();this.getElement().replaceChild(newelement,placeholder)}_addColumn(){this.reactive.dispatch("addColumn",0)}validateDropData(dropdata){return"column"==(null==dropdata?void 0:dropdata.type)}drop(dropdata){this.reactive.dispatch("moveColumn",dropdata.id,0)}showDropZone(){this.getElement(_selectors.default.ADDCOLUMNCONTAINER).classList.add("mod_kanban_insert")}hideDropZone(){this.getElement(_selectors.default.ADDCOLUMNCONTAINER).classList.remove("mod_kanban_insert")}}return _exports.default=_default,_exports.default}));

//# sourceMappingURL=board.min.js.map